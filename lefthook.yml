pre-commit:
  commands:
    fmt:
      run: alejandra {staged_files}
      glob: "*.nix"
      stage_fixed: true

pre-push:
  commands:
    dry-build:
      run: nh os build . --hostname daisy --no-nom --quiet -- --quiet

post-commit:
  commands:
    push:
      run: setsid sh -c 'flock -n /tmp/dotfiles-push.lock git push' &

post-push:
  commands:
    comin-fetch:
      run: comin fetch
